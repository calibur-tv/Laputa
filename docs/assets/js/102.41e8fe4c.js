(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{356:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[a("a",{attrs:{href:"https://travis-ci.org/namshi/jose",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://travis-ci.org/namshi/jose.svg",alt:"Build Status"}}),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://packagist.org/packages/namshi/jose",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://poser.pugx.org/namshi/jose/v/stable",alt:"Latest Stable Version"}}),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://packagist.org/packages/namshi/jose",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://poser.pugx.org/namshi/jose/downloads",alt:"Total Downloads"}}),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://packagist.org/packages/namshi/jose",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://poser.pugx.org/namshi/jose/license",alt:"License"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("This library provides a lightweight\nimplementation of the JWS\n("),a("a",{attrs:{href:"http://tools.ietf.org/html/draft-jones-json-web-signature-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON Web Signature"),a("OutboundLink")],1),t._v(") specification.")]),t._v(" "),t._m(1),t._v(" "),a("p",[t._v("This library needs PHP 5.5+ and the library OpenSSL.")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),a("p",[t._v("You can install the library directly from\ncomposer / "),a("a",{attrs:{href:"https://packagist.org/packages/namshi/jose",target:"_blank",rel:"noopener noreferrer"}},[t._v("packagist"),a("OutboundLink")],1),t._v(":")]),t._v(" "),t._m(4),t._m(5),t._v(" "),a("p",[t._v("Using it is pretty straightforward:\nimagine that you want to offer a service\nthe ability to authenticate a user via\na cookie, and the service is built with\njavascript; what you would need to do is\nto generate a JWS (after verifying the\ncredentials once), store it as a cookie\nand then pass it from your JavaScript app\neverytime you want to authenticate that\nuser.")]),t._v(" "),a("p",[t._v("First, generate the JWS:")]),t._v(" "),t._m(6),a("p",[t._v("Then your JS app can use the available cookie to execute\nauthenticated calls, without sending passwords or credentials.")]),t._v(" "),a("p",[t._v("Once a request is submitted, you only have to verify that it\nis a valid call:")]),t._v(" "),t._m(7),t._m(8),t._v(" "),t._m(9),t._v(" "),a("p",[t._v("You may find that you need to use this library in an environment where\n"),a("a",{attrs:{href:"http://php.net/manual/en/ref.openssl.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP's wrappers for OpenSSL"),a("OutboundLink")],1),t._v("\ndo not work, or OpenSSL simply is not installed.  This library uses\nOpenSSL to encrypt by default, but you can specify that you want to use "),a("a",{attrs:{href:"http://phpseclib.sourceforge.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHPSecLib"),a("OutboundLink")],1),t._v(" for a pure PHP\nimplementation of RSA encryption.")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),a("p",[t._v("You may also load a JWS using the PHPSecLib implementation of RSA verification:")]),t._v(" "),t._m(14),t._m(15),t._v(" "),a("p",[t._v("In order to "),a("a",{attrs:{href:"https://github.com/namshi/jose/blob/master/src/Namshi/JOSE/SimpleJWS.php#L43",target:"_blank",rel:"noopener noreferrer"}},[t._v("validate the JWS"),a("OutboundLink")],1),t._v(",\nthe signature is first "),a("a",{attrs:{href:"https://github.com/namshi/jose/blob/master/src/Namshi/JOSE/JWS.php#L113",target:"_blank",rel:"noopener noreferrer"}},[t._v("verified"),a("OutboundLink")],1),t._v("\nwith a public key and then we will check whether the "),a("a",{attrs:{href:"https://github.com/namshi/jose/blob/master/src/Namshi/JOSE/SimpleJWS.php#L55",target:"_blank",rel:"noopener noreferrer"}},[t._v("token is expired"),a("OutboundLink")],1),t._v(".")]),t._v(" "),t._m(16),t._v(" "),t._m(17),t._m(18),t._v(" "),a("p",[t._v("You can allow "),a("a",{attrs:{href:"https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-40#page-12",target:"_blank",rel:"noopener noreferrer"}},[t._v("unsecure JWSes"),a("OutboundLink")],1),t._v("\nby setting the "),a("code",[t._v("$allowUnsecure")]),t._v(" flag while loading JWSes:")]),t._v(" "),t._m(19),a("p",[t._v("This allows tokens signed with the 'none' algorithms to go through, which is something\nyou probably don't want to do. Proceed with caution ðŸ˜ƒ")]),t._v(" "),a("p",[a("strong",[t._v("Unsecure JWSes are disabled by default since version 2.2.2. You should "),a("strong",[t._v("not")]),t._v("\nuse previous versions other than 2.2.2 as they have a security\nvulnerability. More info "),a("a",{attrs:{href:"http://tech.namshi.com/blog/2015/02/19/update-your-namshi-slash-jose-installations-as-a-security-vulnerability-was-found/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),a("p",[t._v("The library provides a base JWT Class that implements what is needed just for JSON Web Tokens. The JWS Class then extends\nthe JWT class and adds the implementation for signing and verifying using JSON Web Signatures. The SimpleJWS class extends\nthe base JWS class and adds validation of a TTL and inclusion of automatic claims.")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),a("p",[t._v("Introduced the ability to specify an encryption engine. Added support of PHPSecLib to the existing OpenSSL implementation.")]),t._v(" "),t._m(25),t._v(" "),a("p",[t._v("Added the ability to set custom properties in the header. Moved automatic inclusion of certain claims into an SimpleJWS class from the base JWS class.")]),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),a("p",[t._v("Moved phpseclib and the openssl extension as suggested dependencies.")]),t._v(" "),t._m(33),t._v(" "),a("p",[t._v("Tests are written using PHPUnit for this library. After doing composer install you can execute the following command to run tests:")]),t._v(" "),t._m(34),t._m(35),t._v(" "),a("p",[t._v("This library has been inspired by the\n"),a("a",{attrs:{href:"https://github.com/ritou/php-Akita_JOSE",target:"_blank",rel:"noopener noreferrer"}},[t._v("initial work done by @ritou"),a("OutboundLink")],1),t._v(".")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"namshi-jose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#namshi-jose","aria-hidden":"true"}},[this._v("#")]),this._v(" NAMSHI | JOSE")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"prerequisites"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites","aria-hidden":"true"}},[this._v("#")]),this._v(" Prerequisites")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("It has been tested using "),s("code",[this._v("PHP5.5")]),this._v(" to "),s("code",[this._v("PHP7.0")]),this._v(" and "),s("code",[this._v("HHVM")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation","aria-hidden":"true"}},[this._v("#")]),this._v(" Installation")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('"namshi/jose": "7.0.*"\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usage","aria-hidden":"true"}},[this._v("#")]),this._v(" Usage")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token php language-php"}},[a("span",{attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{attrs:{class:"token package"}},[t._v("Namshi"),a("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("JOSE"),a("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SimpleJWS")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$username")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'correctUsername'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$pass")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'ok'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{attrs:{class:"token variable"}},[t._v("$user")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Db"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token function"}},[t._v("loadUserByUsername")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$username")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),t._v("  "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("SimpleJWS")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("array")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t\t"),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'alg'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'RS256'")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("setPayload")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("array")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t\t"),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'uid'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$user")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("getid")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{attrs:{class:"token variable"}},[t._v("$privateKey")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("openssl_pkey_get_private")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token double-quoted-string string"}},[t._v('"file://path/to/private.key"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" self"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token constant"}},[t._v("SSL_KEY_PASSPHRASE")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("sign")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$privateKey")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("setcookie")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'identity'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("getTokenString")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token php language-php"}},[a("span",{attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{attrs:{class:"token package"}},[t._v("Namshi"),a("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("JOSE"),a("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SimpleJWS")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),t._v("        "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" SimpleJWS"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token function"}},[t._v("load")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$_COOKIE")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'identity'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token variable"}},[t._v("$public_key")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("openssl_pkey_get_public")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token double-quoted-string string"}},[t._v('"/path/to/public.key"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("// verify that the token is valid and had the same values")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// you emitted before while setting it as a cookie")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("isValid")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$public_key")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'RS256'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{attrs:{class:"token variable"}},[t._v("$payload")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("getPayload")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("sprintf")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token double-quoted-string string"}},[t._v('"Hey, my JS app just did an action authenticated as user #%s"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$payload")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'uid'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("PROTIP: you can omit the second argument of the isValid() method, so jose will try to validate the token with the algorithm specified in the token's header, though this might expose you to some security issues.")]),this._v(" "),s("p",[this._v("For now we recommend to always explicitely set the algorithm you want to use to validate tokens.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"phpseclib-for-rsa-verification"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#phpseclib-for-rsa-verification","aria-hidden":"true"}},[this._v("#")]),this._v(" PHPSECLIB For RSA Verification")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("In these cases, simply add the optional "),s("code",[this._v("'SecLib'")]),this._v(" parameter when\nconstructing a JWS:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("JWS")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("array")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'alg'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'RS256'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'SecLib'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("You can now use the PHPSecLib implementation of RSA signing.  If you use\na password protected private key, you can still submit the private key\nto use for signing as a string, as long as you pass the password as the\nsecond parameter into the "),s("code",[this._v("sign")]),this._v(" method:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("sign")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token function"}},[t._v("file_get_contents")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token constant"}},[t._v("SSL_KEYS_PATH")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{attrs:{class:"token double-quoted-string string"}},[t._v('"private.key"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'tests'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token variable"}},[t._v("$jws")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token constant"}},[t._v("JWS")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token function"}},[t._v("load")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$tokenString")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("false")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$encoder")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'SecLib'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"under-the-hood"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#under-the-hood","aria-hidden":"true"}},[this._v("#")]),this._v(" Under the hood")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("To give a JWS a TTL, just use the standard "),s("code",[this._v("exp")]),this._v(" value in the payload:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token variable"}},[t._v("$date")]),t._v("    \t"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("DateTime")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'tomorrow'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token variable"}},[t._v("$this")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token property"}},[t._v("jws")]),t._v("  "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("SimpleJWS")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("array")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'alg'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'RS256'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token variable"}},[t._v("$this")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token property"}},[t._v("jws")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("setPayload")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("array")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t"),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'exp'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token variable"}},[t._v("$date")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("format")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'U'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"unsecure-jwses"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unsecure-jwses","aria-hidden":"true"}},[this._v("#")]),this._v(" Unsecure JWSes")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token constant"}},[t._v("JWS")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token function"}},[t._v("load")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token variable"}},[t._v("$this")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token property"}},[t._v("jws")]),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token function"}},[t._v("getTokenString")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"using-a-custom-encoder"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-custom-encoder","aria-hidden":"true"}},[this._v("#")]),this._v(" Using a custom encoder")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If, for some reason, you need to encode the token in a different way, you can\ninject any implementation of "),s("code",[this._v("Namshi\\JOSE\\Base64\\Encoder")]),this._v(" in a "),s("code",[this._v("JWS")]),this._v(" instance.\nLikewise, "),s("code",[this._v("JWS::load()")]),this._v(" accepts such an implementation as a second argument.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"implementation-specifics"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#implementation-specifics","aria-hidden":"true"}},[this._v("#")]),this._v(" Implementation Specifics")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"major-versions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#major-versions","aria-hidden":"true"}},[this._v("#")]),this._v(" Major Versions")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-x-x-to-3-x-x"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-x-x-to-3-x-x","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.x.x to 3.x.x")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-x-x-to-4-x-x-not-backwards-compatible"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-x-x-to-4-x-x-not-backwards-compatible","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.x.x to 4.x.x - Not Backwards Compatible")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_6-x-x-not-backwards-compatible"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-x-x-not-backwards-compatible","aria-hidden":"true"}},[this._v("#")]),this._v(" 6.x.x - Not Backwards Compatible")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_6-1-x"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-x","aria-hidden":"true"}},[this._v("#")]),this._v(" 6.1.x")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Dropped support for PHP 5.4")]),this._v(" "),s("li",[this._v("phpseclib 2.0")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_6-0-x"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-0-x","aria-hidden":"true"}},[this._v("#")]),this._v(" 6.0.x")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Dropped support for PHP 5.3")]),this._v(" "),s("li",[this._v("Don't escape slashes when generating signin input.\nThis may render tokens generated with earlier versions of Jose incompatible.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_7-x-x"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-x-x","aria-hidden":"true"}},[this._v("#")]),this._v(" 7.x.x")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_7-0-x"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-0-x","aria-hidden":"true"}},[this._v("#")]),this._v(" 7.0.x")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"tests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tests","aria-hidden":"true"}},[this._v("#")]),this._v(" Tests")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("./vendor/bin/phpunit\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"credits"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#credits","aria-hidden":"true"}},[this._v("#")]),this._v(" Credits")])}],!1,null,null,null);s.default=e.exports}}]);
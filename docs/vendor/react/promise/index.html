<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hello VuePress</title>
    <meta name="description" content="Just playing around">
    <link rel="icon" href="https://static.calibur.tv/favicon.ico">
    
    <link rel="preload" href="Laputa/assets/css/0.styles.21b3d02c.css" as="style"><link rel="preload" href="Laputa/assets/js/app.6f999ec1.js" as="script"><link rel="preload" href="Laputa/assets/js/161.df7bc156.js" as="script"><link rel="prefetch" href="Laputa/assets/js/127.5d5c2a9e.js"><link rel="prefetch" href="Laputa/assets/js/2.cda51ec0.js"><link rel="prefetch" href="Laputa/assets/js/3.a88ade89.js"><link rel="prefetch" href="Laputa/assets/js/4.f0a47b5a.js"><link rel="prefetch" href="Laputa/assets/js/5.eb4e2f15.js"><link rel="prefetch" href="Laputa/assets/js/6.ae349cfe.js"><link rel="prefetch" href="Laputa/assets/js/7.d8abf350.js"><link rel="prefetch" href="Laputa/assets/js/8.7660bbc3.js"><link rel="prefetch" href="Laputa/assets/js/9.9282dabe.js"><link rel="prefetch" href="Laputa/assets/js/10.ea22ba46.js"><link rel="prefetch" href="Laputa/assets/js/11.ed71705a.js"><link rel="prefetch" href="Laputa/assets/js/12.bab571ae.js"><link rel="prefetch" href="Laputa/assets/js/13.78fc55ea.js"><link rel="prefetch" href="Laputa/assets/js/14.765cca5f.js"><link rel="prefetch" href="Laputa/assets/js/15.7f1ee911.js"><link rel="prefetch" href="Laputa/assets/js/16.1de690fb.js"><link rel="prefetch" href="Laputa/assets/js/17.0c9bcfe7.js"><link rel="prefetch" href="Laputa/assets/js/18.4ea1b5ec.js"><link rel="prefetch" href="Laputa/assets/js/19.8c8f8b57.js"><link rel="prefetch" href="Laputa/assets/js/20.9129a22f.js"><link rel="prefetch" href="Laputa/assets/js/21.b84b104e.js"><link rel="prefetch" href="Laputa/assets/js/22.fe164d26.js"><link rel="prefetch" href="Laputa/assets/js/23.dee79d2c.js"><link rel="prefetch" href="Laputa/assets/js/24.7a76775e.js"><link rel="prefetch" href="Laputa/assets/js/25.57b548b0.js"><link rel="prefetch" href="Laputa/assets/js/26.22bea336.js"><link rel="prefetch" href="Laputa/assets/js/27.f372908a.js"><link rel="prefetch" href="Laputa/assets/js/28.7c33523e.js"><link rel="prefetch" href="Laputa/assets/js/29.0b631070.js"><link rel="prefetch" href="Laputa/assets/js/30.fde1b56c.js"><link rel="prefetch" href="Laputa/assets/js/31.19440d0b.js"><link rel="prefetch" href="Laputa/assets/js/32.09c05419.js"><link rel="prefetch" href="Laputa/assets/js/33.f24b2fa1.js"><link rel="prefetch" href="Laputa/assets/js/34.704234d2.js"><link rel="prefetch" href="Laputa/assets/js/35.3538aa16.js"><link rel="prefetch" href="Laputa/assets/js/36.9fd936b8.js"><link rel="prefetch" href="Laputa/assets/js/37.029a950c.js"><link rel="prefetch" href="Laputa/assets/js/38.ca2d406b.js"><link rel="prefetch" href="Laputa/assets/js/39.6d640b65.js"><link rel="prefetch" href="Laputa/assets/js/40.da4aa4d2.js"><link rel="prefetch" href="Laputa/assets/js/41.15815f6e.js"><link rel="prefetch" href="Laputa/assets/js/42.87b4655d.js"><link rel="prefetch" href="Laputa/assets/js/43.87956add.js"><link rel="prefetch" href="Laputa/assets/js/44.ed836e06.js"><link rel="prefetch" href="Laputa/assets/js/45.f6149b9c.js"><link rel="prefetch" href="Laputa/assets/js/46.57e569c9.js"><link rel="prefetch" href="Laputa/assets/js/47.53bc0ff4.js"><link rel="prefetch" href="Laputa/assets/js/48.e16402f6.js"><link rel="prefetch" href="Laputa/assets/js/49.ef4b9870.js"><link rel="prefetch" href="Laputa/assets/js/50.97b2795a.js"><link rel="prefetch" href="Laputa/assets/js/51.1df1f3d1.js"><link rel="prefetch" href="Laputa/assets/js/52.727e7778.js"><link rel="prefetch" href="Laputa/assets/js/53.f8356a1e.js"><link rel="prefetch" href="Laputa/assets/js/54.8f15ada1.js"><link rel="prefetch" href="Laputa/assets/js/55.fc41623e.js"><link rel="prefetch" href="Laputa/assets/js/56.b65567d0.js"><link rel="prefetch" href="Laputa/assets/js/57.3cb52983.js"><link rel="prefetch" href="Laputa/assets/js/58.ff69625f.js"><link rel="prefetch" href="Laputa/assets/js/59.b99f5762.js"><link rel="prefetch" href="Laputa/assets/js/60.b7c53f3f.js"><link rel="prefetch" href="Laputa/assets/js/61.2757576d.js"><link rel="prefetch" href="Laputa/assets/js/62.5d25765e.js"><link rel="prefetch" href="Laputa/assets/js/63.a6b7406e.js"><link rel="prefetch" href="Laputa/assets/js/64.7bba8fd1.js"><link rel="prefetch" href="Laputa/assets/js/65.6e593ebf.js"><link rel="prefetch" href="Laputa/assets/js/66.b926ddd2.js"><link rel="prefetch" href="Laputa/assets/js/67.c8c69cd3.js"><link rel="prefetch" href="Laputa/assets/js/68.cb4bb5cb.js"><link rel="prefetch" href="Laputa/assets/js/69.a7b09174.js"><link rel="prefetch" href="Laputa/assets/js/70.02c49833.js"><link rel="prefetch" href="Laputa/assets/js/71.1c53c636.js"><link rel="prefetch" href="Laputa/assets/js/72.bb0f586e.js"><link rel="prefetch" href="Laputa/assets/js/73.aa250a71.js"><link rel="prefetch" href="Laputa/assets/js/74.fcd8312b.js"><link rel="prefetch" href="Laputa/assets/js/75.ee561d5e.js"><link rel="prefetch" href="Laputa/assets/js/76.8d6c7d11.js"><link rel="prefetch" href="Laputa/assets/js/77.3c5c7747.js"><link rel="prefetch" href="Laputa/assets/js/78.0afb8d36.js"><link rel="prefetch" href="Laputa/assets/js/79.e09176dc.js"><link rel="prefetch" href="Laputa/assets/js/80.6add3555.js"><link rel="prefetch" href="Laputa/assets/js/81.46dfeac8.js"><link rel="prefetch" href="Laputa/assets/js/82.8c7bae69.js"><link rel="prefetch" href="Laputa/assets/js/83.3c1031f4.js"><link rel="prefetch" href="Laputa/assets/js/84.5414c057.js"><link rel="prefetch" href="Laputa/assets/js/85.434414f7.js"><link rel="prefetch" href="Laputa/assets/js/86.032ff5b5.js"><link rel="prefetch" href="Laputa/assets/js/87.1387e175.js"><link rel="prefetch" href="Laputa/assets/js/88.ef068175.js"><link rel="prefetch" href="Laputa/assets/js/89.3c86a439.js"><link rel="prefetch" href="Laputa/assets/js/90.7b4ceab8.js"><link rel="prefetch" href="Laputa/assets/js/91.993029ce.js"><link rel="prefetch" href="Laputa/assets/js/92.cd0f0552.js"><link rel="prefetch" href="Laputa/assets/js/93.2ea5e4ed.js"><link rel="prefetch" href="Laputa/assets/js/94.d77f771e.js"><link rel="prefetch" href="Laputa/assets/js/95.bfb1166d.js"><link rel="prefetch" href="Laputa/assets/js/96.d656aebb.js"><link rel="prefetch" href="Laputa/assets/js/97.8d318516.js"><link rel="prefetch" href="Laputa/assets/js/98.836a48cc.js"><link rel="prefetch" href="Laputa/assets/js/99.90560d29.js"><link rel="prefetch" href="Laputa/assets/js/100.a889b1b9.js"><link rel="prefetch" href="Laputa/assets/js/101.92c2d09f.js"><link rel="prefetch" href="Laputa/assets/js/102.41e8fe4c.js"><link rel="prefetch" href="Laputa/assets/js/103.1e7ebc3c.js"><link rel="prefetch" href="Laputa/assets/js/104.9b5e097e.js"><link rel="prefetch" href="Laputa/assets/js/105.664970bd.js"><link rel="prefetch" href="Laputa/assets/js/106.61b9108e.js"><link rel="prefetch" href="Laputa/assets/js/107.fffe8d0f.js"><link rel="prefetch" href="Laputa/assets/js/108.6ab1e942.js"><link rel="prefetch" href="Laputa/assets/js/109.df13f020.js"><link rel="prefetch" href="Laputa/assets/js/110.3ee4fa68.js"><link rel="prefetch" href="Laputa/assets/js/111.b836e8af.js"><link rel="prefetch" href="Laputa/assets/js/112.a83b7d02.js"><link rel="prefetch" href="Laputa/assets/js/113.ded87a86.js"><link rel="prefetch" href="Laputa/assets/js/114.297ad3a1.js"><link rel="prefetch" href="Laputa/assets/js/115.544749de.js"><link rel="prefetch" href="Laputa/assets/js/116.a8d4b51b.js"><link rel="prefetch" href="Laputa/assets/js/117.4f44196d.js"><link rel="prefetch" href="Laputa/assets/js/118.89df9a9d.js"><link rel="prefetch" href="Laputa/assets/js/119.2dba598a.js"><link rel="prefetch" href="Laputa/assets/js/120.fc3b4984.js"><link rel="prefetch" href="Laputa/assets/js/121.9fdd6483.js"><link rel="prefetch" href="Laputa/assets/js/122.b56010ca.js"><link rel="prefetch" href="Laputa/assets/js/123.41518099.js"><link rel="prefetch" href="Laputa/assets/js/124.2353c219.js"><link rel="prefetch" href="Laputa/assets/js/125.16055535.js"><link rel="prefetch" href="Laputa/assets/js/126.9edc34c6.js"><link rel="prefetch" href="Laputa/assets/js/128.483176b9.js"><link rel="prefetch" href="Laputa/assets/js/129.d0a84feb.js"><link rel="prefetch" href="Laputa/assets/js/130.e8a23474.js"><link rel="prefetch" href="Laputa/assets/js/131.46723320.js"><link rel="prefetch" href="Laputa/assets/js/132.a9d65b65.js"><link rel="prefetch" href="Laputa/assets/js/133.565a1e84.js"><link rel="prefetch" href="Laputa/assets/js/134.9a13e04e.js"><link rel="prefetch" href="Laputa/assets/js/135.c29729f1.js"><link rel="prefetch" href="Laputa/assets/js/136.1e528d9b.js"><link rel="prefetch" href="Laputa/assets/js/137.ae8b404d.js"><link rel="prefetch" href="Laputa/assets/js/138.be0e6cbb.js"><link rel="prefetch" href="Laputa/assets/js/139.237416e3.js"><link rel="prefetch" href="Laputa/assets/js/140.4ab9ca1a.js"><link rel="prefetch" href="Laputa/assets/js/141.74e2f092.js"><link rel="prefetch" href="Laputa/assets/js/142.0ecb3a43.js"><link rel="prefetch" href="Laputa/assets/js/143.be6d4143.js"><link rel="prefetch" href="Laputa/assets/js/144.1985fb6e.js"><link rel="prefetch" href="Laputa/assets/js/145.37a16214.js"><link rel="prefetch" href="Laputa/assets/js/146.3b54b80d.js"><link rel="prefetch" href="Laputa/assets/js/147.cd7a75ec.js"><link rel="prefetch" href="Laputa/assets/js/148.c069a727.js"><link rel="prefetch" href="Laputa/assets/js/149.31e9b53c.js"><link rel="prefetch" href="Laputa/assets/js/150.97670c74.js"><link rel="prefetch" href="Laputa/assets/js/151.ea21f131.js"><link rel="prefetch" href="Laputa/assets/js/152.7fb53639.js"><link rel="prefetch" href="Laputa/assets/js/153.fc1a3224.js"><link rel="prefetch" href="Laputa/assets/js/154.d139b199.js"><link rel="prefetch" href="Laputa/assets/js/155.d8803711.js"><link rel="prefetch" href="Laputa/assets/js/156.b5f75d9b.js"><link rel="prefetch" href="Laputa/assets/js/157.534cff67.js"><link rel="prefetch" href="Laputa/assets/js/158.507711d4.js"><link rel="prefetch" href="Laputa/assets/js/159.bbe8196f.js"><link rel="prefetch" href="Laputa/assets/js/160.01a377d7.js"><link rel="prefetch" href="Laputa/assets/js/162.4c050e9a.js"><link rel="prefetch" href="Laputa/assets/js/163.f633cfe3.js"><link rel="prefetch" href="Laputa/assets/js/164.9a7cde98.js"><link rel="prefetch" href="Laputa/assets/js/165.8383c6e0.js"><link rel="prefetch" href="Laputa/assets/js/166.84973e7b.js"><link rel="prefetch" href="Laputa/assets/js/167.139a83e5.js"><link rel="prefetch" href="Laputa/assets/js/168.b0d2bd4d.js"><link rel="prefetch" href="Laputa/assets/js/169.e800feb9.js"><link rel="prefetch" href="Laputa/assets/js/170.f9451e36.js"><link rel="prefetch" href="Laputa/assets/js/171.a83a4665.js"><link rel="prefetch" href="Laputa/assets/js/172.c211eed7.js"><link rel="prefetch" href="Laputa/assets/js/173.c3a50a74.js"><link rel="prefetch" href="Laputa/assets/js/174.eb3ff294.js"><link rel="prefetch" href="Laputa/assets/js/175.710a54ce.js"><link rel="prefetch" href="Laputa/assets/js/176.b8b0c286.js"><link rel="prefetch" href="Laputa/assets/js/177.53f441fa.js"><link rel="prefetch" href="Laputa/assets/js/178.81400b25.js"><link rel="prefetch" href="Laputa/assets/js/179.8d7755c9.js"><link rel="prefetch" href="Laputa/assets/js/180.cb1b319d.js"><link rel="prefetch" href="Laputa/assets/js/181.897fd3aa.js"><link rel="prefetch" href="Laputa/assets/js/182.5bbea4a6.js"><link rel="prefetch" href="Laputa/assets/js/183.59d5d5b7.js"><link rel="prefetch" href="Laputa/assets/js/184.7a6514a7.js"><link rel="prefetch" href="Laputa/assets/js/185.26dd8cdd.js"><link rel="prefetch" href="Laputa/assets/js/186.978c4dde.js"><link rel="prefetch" href="Laputa/assets/js/187.2ee204e3.js"><link rel="prefetch" href="Laputa/assets/js/188.29baaca4.js"><link rel="prefetch" href="Laputa/assets/js/189.fe643f03.js"><link rel="prefetch" href="Laputa/assets/js/190.dd3ce693.js"><link rel="prefetch" href="Laputa/assets/js/191.c9ffbdf3.js"><link rel="prefetch" href="Laputa/assets/js/192.402577fb.js"><link rel="prefetch" href="Laputa/assets/js/193.4278458a.js"><link rel="prefetch" href="Laputa/assets/js/194.26c0a999.js"><link rel="prefetch" href="Laputa/assets/js/195.b3bbd6f1.js"><link rel="prefetch" href="Laputa/assets/js/196.ec2775a6.js"><link rel="prefetch" href="Laputa/assets/js/197.7a1de435.js"><link rel="prefetch" href="Laputa/assets/js/198.b0d0b4b2.js"><link rel="prefetch" href="Laputa/assets/js/199.68e2f133.js"><link rel="prefetch" href="Laputa/assets/js/200.ac303e12.js"><link rel="prefetch" href="Laputa/assets/js/201.629c56c3.js"><link rel="prefetch" href="Laputa/assets/js/202.f8efe17e.js"><link rel="prefetch" href="Laputa/assets/js/203.24648560.js"><link rel="prefetch" href="Laputa/assets/js/204.413e0508.js"><link rel="prefetch" href="Laputa/assets/js/205.a575ce92.js"><link rel="prefetch" href="Laputa/assets/js/206.7c9b685e.js"><link rel="prefetch" href="Laputa/assets/js/207.1ab88c98.js"><link rel="prefetch" href="Laputa/assets/js/208.351562e6.js"><link rel="prefetch" href="Laputa/assets/js/209.1b054dd4.js"><link rel="prefetch" href="Laputa/assets/js/210.1e8ec36f.js"><link rel="prefetch" href="Laputa/assets/js/211.bd920edf.js"><link rel="prefetch" href="Laputa/assets/js/212.ebc1bea5.js"><link rel="prefetch" href="Laputa/assets/js/213.353cd010.js"><link rel="prefetch" href="Laputa/assets/js/214.4833f3e1.js"><link rel="prefetch" href="Laputa/assets/js/215.1946cb78.js"><link rel="prefetch" href="Laputa/assets/js/216.26c1e1d5.js"><link rel="prefetch" href="Laputa/assets/js/217.ba12abbd.js"><link rel="prefetch" href="Laputa/assets/js/218.4e7296f1.js"><link rel="prefetch" href="Laputa/assets/js/219.529550de.js"><link rel="prefetch" href="Laputa/assets/js/220.b8021d90.js"><link rel="prefetch" href="Laputa/assets/js/221.802a3551.js"><link rel="prefetch" href="Laputa/assets/js/222.bc0d810e.js"><link rel="prefetch" href="Laputa/assets/js/223.8cdfb2ab.js"><link rel="prefetch" href="Laputa/assets/js/224.7c4d2af9.js"><link rel="prefetch" href="Laputa/assets/js/225.3ee841fd.js"><link rel="prefetch" href="Laputa/assets/js/226.7df98d80.js"><link rel="prefetch" href="Laputa/assets/js/227.f8cf7429.js"><link rel="prefetch" href="Laputa/assets/js/228.1bbe3cd5.js"><link rel="prefetch" href="Laputa/assets/js/229.9255cc40.js"><link rel="prefetch" href="Laputa/assets/js/230.9fe34f11.js"><link rel="prefetch" href="Laputa/assets/js/231.4162b6b5.js"><link rel="prefetch" href="Laputa/assets/js/232.49ddd09a.js"><link rel="prefetch" href="Laputa/assets/js/233.7a3b967d.js"><link rel="prefetch" href="Laputa/assets/js/234.7df4ccbc.js"><link rel="prefetch" href="Laputa/assets/js/235.8439e9f2.js"><link rel="prefetch" href="Laputa/assets/js/236.3bec368c.js"><link rel="prefetch" href="Laputa/assets/js/237.159a831f.js"><link rel="prefetch" href="Laputa/assets/js/238.67f44d76.js"><link rel="prefetch" href="Laputa/assets/js/239.34b19aa7.js"><link rel="prefetch" href="Laputa/assets/js/240.cbcf457d.js"><link rel="prefetch" href="Laputa/assets/js/241.58c5bf48.js"><link rel="prefetch" href="Laputa/assets/js/242.23600eb9.js"><link rel="prefetch" href="Laputa/assets/js/243.7ed95623.js"><link rel="prefetch" href="Laputa/assets/js/244.ff6b7298.js"><link rel="prefetch" href="Laputa/assets/js/245.9cf038e8.js"><link rel="prefetch" href="Laputa/assets/js/246.fa1277bb.js"><link rel="prefetch" href="Laputa/assets/js/247.11fee991.js"><link rel="prefetch" href="Laputa/assets/js/248.3655e1e1.js"><link rel="prefetch" href="Laputa/assets/js/249.8fbd4f7c.js"><link rel="prefetch" href="Laputa/assets/js/250.85d161fa.js"><link rel="prefetch" href="Laputa/assets/js/251.481032de.js"><link rel="prefetch" href="Laputa/assets/js/252.6157489d.js"><link rel="prefetch" href="Laputa/assets/js/253.f91926ff.js"><link rel="prefetch" href="Laputa/assets/js/254.b7fad364.js"><link rel="prefetch" href="Laputa/assets/js/255.73dc5cad.js"><link rel="prefetch" href="Laputa/assets/js/256.6b658f8a.js">
    <link rel="stylesheet" href="Laputa/assets/css/0.styles.21b3d02c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Laputa/" class="home-link router-link-active"><!----> <span class="site-name">Hello VuePress</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <!----> </div> <div class="page"> <div class="content"><h1 id="react-promise"><a href="#react-promise" aria-hidden="true" class="header-anchor">#</a> React/Promise</h1> <p>A lightweight implementation of
<a href="http://wiki.commonjs.org/wiki/Promises/A" target="_blank" rel="noopener noreferrer">CommonJS Promises/A<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for PHP.</p> <p><a href="http://travis-ci.org/reactphp/promise" target="_blank" rel="noopener noreferrer"><img src="https://travis-ci.org/reactphp/promise.svg?branch=master" alt="Build Status"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://coveralls.io/github/reactphp/promise?branch=master" target="_blank" rel="noopener noreferrer"><img src="https://coveralls.io/repos/github/reactphp/promise/badge.svg?branch=master" alt="Coverage Status"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="table-of-contents"><a href="#table-of-contents" aria-hidden="true" class="header-anchor">#</a> Table of Contents</h2> <ol><li><a href="#introduction">Introduction</a></li> <li><a href="#concepts">Concepts</a> <ul><li><a href="#deferred">Deferred</a></li> <li><a href="#promise">Promise</a></li></ul></li> <li><a href="#api">API</a> <ul><li><a href="#deferred-1">Deferred</a> <ul><li><a href="#deferredpromise">Deferred::promise()</a></li> <li><a href="#deferredresolve">Deferred::resolve()</a></li> <li><a href="#deferredreject">Deferred::reject()</a></li> <li><a href="#deferrednotify">Deferred::notify()</a></li></ul></li> <li><a href="#promiseinterface">PromiseInterface</a> <ul><li><a href="#promiseinterfacethen">PromiseInterface::then()</a></li></ul></li> <li><a href="#extendedpromiseinterface">ExtendedPromiseInterface</a> <ul><li><a href="#extendedpromiseinterfacedone">ExtendedPromiseInterface::done()</a></li> <li><a href="#extendedpromiseinterfaceotherwise">ExtendedPromiseInterface::otherwise()</a></li> <li><a href="#extendedpromiseinterfacealways">ExtendedPromiseInterface::always()</a></li> <li><a href="#extendedpromiseinterfaceprogress">ExtendedPromiseInterface::progress()</a></li></ul></li> <li><a href="#cancellablepromiseinterface">CancellablePromiseInterface</a> <ul><li><a href="#cancellablepromiseinterfacecancel">CancellablePromiseInterface::cancel()</a></li></ul></li> <li><a href="#promise-1">Promise</a></li> <li><a href="#fulfilledpromise">FulfilledPromise</a></li> <li><a href="#rejectedpromise">RejectedPromise</a></li> <li><a href="#lazypromise">LazyPromise</a></li> <li><a href="#functions">Functions</a> <ul><li><a href="#resolve">resolve()</a></li> <li><a href="#reject">reject()</a></li> <li><a href="#all">all()</a></li> <li><a href="#race">race()</a></li> <li><a href="#any">any()</a></li> <li><a href="#some">some()</a></li> <li><a href="#map">map()</a></li> <li><a href="#reduce">reduce()</a></li></ul></li> <li><a href="#promisorinterface">PromisorInterface</a></li></ul></li> <li><a href="#examples">Examples</a> <ul><li><a href="#how-to-use-deferred">How to use Deferred</a></li> <li><a href="#how-promise-forwarding-works">How promise forwarding works</a> <ul><li><a href="#resolution-forwarding">Resolution forwarding</a></li> <li><a href="#rejection-forwarding">Rejection forwarding</a></li> <li><a href="#mixed-resolution-and-rejection-forwarding">Mixed resolution and rejection forwarding</a></li> <li><a href="#progress-event-forwarding">Progress event forwarding</a></li></ul></li> <li><a href="#done-vs-then">done() vs. then()</a></li></ul></li> <li><a href="#credits">Credits</a></li> <li><a href="#license">License</a></li></ol> <h2 id="introduction"><a href="#introduction" aria-hidden="true" class="header-anchor">#</a> Introduction</h2> <p>React/Promise is a library implementing
<a href="http://wiki.commonjs.org/wiki/Promises/A" target="_blank" rel="noopener noreferrer">CommonJS Promises/A<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for PHP.</p> <p>It also provides several other useful promise-related concepts, such as joining
multiple promises and mapping and reducing collections of promises.</p> <p>If you've never heard about promises before,
<a href="https://gist.github.com/3889970" target="_blank" rel="noopener noreferrer">read this first<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="concepts"><a href="#concepts" aria-hidden="true" class="header-anchor">#</a> Concepts</h2> <h3 id="deferred"><a href="#deferred" aria-hidden="true" class="header-anchor">#</a> Deferred</h3> <p>A <strong>Deferred</strong> represents a computation or unit of work that may not have
completed yet. Typically (but not always), that computation will be something
that executes asynchronously and completes at some point in the future.</p> <h3 id="promise"><a href="#promise" aria-hidden="true" class="header-anchor">#</a> Promise</h3> <p>While a deferred represents the computation itself, a <strong>Promise</strong> represents
the result of that computation. Thus, each deferred has a promise that acts as
a placeholder for its actual result.</p> <h2 id="api"><a href="#api" aria-hidden="true" class="header-anchor">#</a> API</h2> <h3 id="deferred-2"><a href="#deferred-2" aria-hidden="true" class="header-anchor">#</a> Deferred</h3> <p>A deferred represents an operation whose resolution is pending. It has separate
promise and resolver parts.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">React<span class="token punctuation">\</span>Promise<span class="token punctuation">\</span>Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$promise</span> <span class="token operator">=</span> <span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span>mixed <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span>mixed <span class="token variable">$reason</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span>mixed <span class="token variable">$update</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>promise</code> method returns the promise of the deferred.</p> <p>The <code>resolve</code> and <code>reject</code> methods control the state of the deferred.</p> <p>The <code>notify</code> method is for progress notification.</p> <p>The constructor of the <code>Deferred</code> accepts an optional <code>$canceller</code> argument.
See <a href="#promise-1">Promise</a> for more information.</p> <h4 id="deferred-promise"><a href="#deferred-promise" aria-hidden="true" class="header-anchor">#</a> Deferred::promise()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> <span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns the promise of the deferred, which you can hand out to others while
keeping the authority to modify its state to yourself.</p> <h4 id="deferred-resolve"><a href="#deferred-resolve" aria-hidden="true" class="header-anchor">#</a> Deferred::resolve()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span>mixed <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Resolves the promise returned by <code>promise()</code>. All consumers are notified by
having <code>$onFulfilled</code> (which they registered via <code>$promise-&gt;then()</code>) called with
<code>$value</code>.</p> <p>If <code>$value</code> itself is a promise, the promise will transition to the state of
this promise once it is resolved.</p> <h4 id="deferred-reject"><a href="#deferred-reject" aria-hidden="true" class="header-anchor">#</a> Deferred::reject()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span>mixed <span class="token variable">$reason</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Rejects the promise returned by <code>promise()</code>, signalling that the deferred's
computation failed.
All consumers are notified by having <code>$onRejected</code> (which they registered via
<code>$promise-&gt;then()</code>) called with <code>$reason</code>.</p> <p>If <code>$reason</code> itself is a promise, the promise will be rejected with the outcome
of this promise regardless whether it fulfills or rejects.</p> <h4 id="deferred-notify"><a href="#deferred-notify" aria-hidden="true" class="header-anchor">#</a> Deferred::notify()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span>mixed <span class="token variable">$update</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Triggers progress notifications, to indicate to consumers that the computation
is making progress toward its result.</p> <p>All consumers are notified by having <code>$onProgress</code> (which they registered via
<code>$promise-&gt;then()</code>) called with <code>$update</code>.</p> <h3 id="promiseinterface"><a href="#promiseinterface" aria-hidden="true" class="header-anchor">#</a> PromiseInterface</h3> <p>The promise interface provides the common interface for all promise
implementations.</p> <p>A promise represents an eventual outcome, which is either fulfillment (success)
and an associated value, or rejection (failure) and an associated reason.</p> <p>Once in the fulfilled or rejected state, a promise becomes immutable.
Neither its state nor its result (or error) can be modified.</p> <h4 id="implementations"><a href="#implementations" aria-hidden="true" class="header-anchor">#</a> Implementations</h4> <ul><li><a href="#promise-1">Promise</a></li> <li><a href="#fulfilledpromise">FulfilledPromise</a></li> <li><a href="#rejectedpromise">RejectedPromise</a></li> <li><a href="#lazypromise">LazyPromise</a></li></ul> <h4 id="promiseinterface-then"><a href="#promiseinterface-then" aria-hidden="true" class="header-anchor">#</a> PromiseInterface::then()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$transformedPromise</span> <span class="token operator">=</span> <span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span>callable <span class="token variable">$onFulfilled</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> callable <span class="token variable">$onRejected</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> callable <span class="token variable">$onProgress</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Transforms a promise's value by applying a function to the promise's fulfillment
or rejection value. Returns a new promise for the transformed result.</p> <p>The <code>then()</code> method registers new fulfilled, rejection and progress handlers
with a promise (all parameters are optional):</p> <ul><li><code>$onFulfilled</code> will be invoked once the promise is fulfilled and passed
the result as the first argument.</li> <li><code>$onRejected</code> will be invoked once the promise is rejected and passed the
reason as the first argument.</li> <li><code>$onProgress</code> will be invoked whenever the producer of the promise
triggers progress notifications and passed a single argument (whatever it
wants) to indicate progress.</li></ul> <p>It returns a new promise that will fulfill with the return value of either
<code>$onFulfilled</code> or <code>$onRejected</code>, whichever is called, or will reject with
the thrown exception if either throws.</p> <p>A promise makes the following guarantees about handlers registered in
the same call to <code>then()</code>:</p> <ol><li>Only one of <code>$onFulfilled</code> or <code>$onRejected</code> will be called,
never both.</li> <li><code>$onFulfilled</code> and <code>$onRejected</code> will never be called more
than once.</li> <li><code>$onProgress</code> may be called multiple times.</li></ol> <h4 id="see-also"><a href="#see-also" aria-hidden="true" class="header-anchor">#</a> See also</h4> <ul><li><a href="#resolve">resolve()</a> - Creating a resolved promise</li> <li><a href="#reject">reject()</a> - Creating a rejected promise</li> <li><a href="#extendedpromiseinterfacedone">ExtendedPromiseInterface::done()</a></li> <li><a href="#done-vs-then">done() vs. then()</a></li></ul> <h3 id="extendedpromiseinterface"><a href="#extendedpromiseinterface" aria-hidden="true" class="header-anchor">#</a> ExtendedPromiseInterface</h3> <p>The ExtendedPromiseInterface extends the PromiseInterface with useful shortcut
and utility methods which are not part of the Promises/A specification.</p> <h4 id="implementations-2"><a href="#implementations-2" aria-hidden="true" class="header-anchor">#</a> Implementations</h4> <ul><li><a href="#promise-1">Promise</a></li> <li><a href="#fulfilledpromise">FulfilledPromise</a></li> <li><a href="#rejectedpromise">RejectedPromise</a></li> <li><a href="#lazypromise">LazyPromise</a></li></ul> <h4 id="extendedpromiseinterface-done"><a href="#extendedpromiseinterface-done" aria-hidden="true" class="header-anchor">#</a> ExtendedPromiseInterface::done()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">done</span><span class="token punctuation">(</span>callable <span class="token variable">$onFulfilled</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> callable <span class="token variable">$onRejected</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> callable <span class="token variable">$onProgress</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Consumes the promise's ultimate value if the promise fulfills, or handles the
ultimate error.</p> <p>It will cause a fatal error if either <code>$onFulfilled</code> or <code>$onRejected</code> throw or
return a rejected promise.</p> <p>Since the purpose of <code>done()</code> is consumption rather than transformation,
<code>done()</code> always returns <code>null</code>.</p> <h4 id="see-also-2"><a href="#see-also-2" aria-hidden="true" class="header-anchor">#</a> See also</h4> <ul><li><a href="#promiseinterfacethen">PromiseInterface::then()</a></li> <li><a href="#done-vs-then">done() vs. then()</a></li></ul> <h4 id="extendedpromiseinterface-otherwise"><a href="#extendedpromiseinterface-otherwise" aria-hidden="true" class="header-anchor">#</a> ExtendedPromiseInterface::otherwise()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">otherwise</span><span class="token punctuation">(</span>callable <span class="token variable">$onRejected</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Registers a rejection handler for promise. It is a shortcut for:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token variable">$onRejected</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Additionally, you can type hint the <code>$reason</code> argument of <code>$onRejected</code> to catch
only specific errors.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">otherwise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>\<span class="token package">RuntimeException</span> <span class="token variable">$reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Only catch \RuntimeException instances</span>
        <span class="token comment">// All other types of errors will propagate automatically</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">otherwise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Catch other errors</span>
    <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="extendedpromiseinterface-always"><a href="#extendedpromiseinterface-always" aria-hidden="true" class="header-anchor">#</a> ExtendedPromiseInterface::always()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$newPromise</span> <span class="token operator">=</span> <span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">always</span><span class="token punctuation">(</span>callable <span class="token variable">$onFulfilledOrRejected</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Allows you to execute &quot;cleanup&quot; type tasks in a promise chain.</p> <p>It arranges for <code>$onFulfilledOrRejected</code> to be called, with no arguments,
when the promise is either fulfilled or rejected.</p> <ul><li>If <code>$promise</code> fulfills, and <code>$onFulfilledOrRejected</code> returns successfully,
<code>$newPromise</code> will fulfill with the same value as <code>$promise</code>.</li> <li>If <code>$promise</code> fulfills, and <code>$onFulfilledOrRejected</code> throws or returns a
rejected promise, <code>$newPromise</code> will reject with the thrown exception or
rejected promise's reason.</li> <li>If <code>$promise</code> rejects, and <code>$onFulfilledOrRejected</code> returns successfully,
<code>$newPromise</code> will reject with the same reason as <code>$promise</code>.</li> <li>If <code>$promise</code> rejects, and <code>$onFulfilledOrRejected</code> throws or returns a
rejected promise, <code>$newPromise</code> will reject with the thrown exception or
rejected promise's reason.</li></ul> <p><code>always()</code> behaves similarly to the synchronous finally statement. When combined
with <code>otherwise()</code>, <code>always()</code> allows you to write code that is similar to the familiar
synchronous catch/finally pair.</p> <p>Consider the following synchronous code:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>\<span class="token package">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">handleError</span><span class="token punctuation">(</span><span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Similar asynchronous code (with <code>doSomething()</code> that returns a promise) can be
written:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">otherwise</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'handleError'</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">always</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'cleanup'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="extendedpromiseinterface-progress"><a href="#extendedpromiseinterface-progress" aria-hidden="true" class="header-anchor">#</a> ExtendedPromiseInterface::progress()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">progress</span><span class="token punctuation">(</span>callable <span class="token variable">$onProgress</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Registers a handler for progress updates from promise. It is a shortcut for:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token variable">$onProgress</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cancellablepromiseinterface"><a href="#cancellablepromiseinterface" aria-hidden="true" class="header-anchor">#</a> CancellablePromiseInterface</h3> <p>A cancellable promise provides a mechanism for consumers to notify the creator
of the promise that they are not longer interested in the result of an
operation.</p> <h4 id="cancellablepromiseinterface-cancel"><a href="#cancellablepromiseinterface-cancel" aria-hidden="true" class="header-anchor">#</a> CancellablePromiseInterface::cancel()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>cancel()</code> method notifies the creator of the promise that there is no
further interest in the results of the operation.</p> <p>Once a promise is settled (either fulfilled or rejected), calling <code>cancel()</code> on
a promise has no effect.</p> <h4 id="implementations-3"><a href="#implementations-3" aria-hidden="true" class="header-anchor">#</a> Implementations</h4> <ul><li><a href="#promise-1">Promise</a></li> <li><a href="#fulfilledpromise">FulfilledPromise</a></li> <li><a href="#rejectedpromise">RejectedPromise</a></li> <li><a href="#lazypromise">LazyPromise</a></li></ul> <h3 id="promise-2"><a href="#promise-2" aria-hidden="true" class="header-anchor">#</a> Promise</h3> <p>Creates a promise whose state is controlled by the functions passed to
<code>$resolver</code>.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$resolver</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>callable <span class="token variable">$resolve</span><span class="token punctuation">,</span> callable <span class="token variable">$reject</span><span class="token punctuation">,</span> callable <span class="token variable">$notify</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do some work, possibly asynchronously, and then</span>
    <span class="token comment">// resolve or reject. You can notify of progress events</span>
    <span class="token comment">// along the way if you want/need.</span>

    <span class="token variable">$resolve</span><span class="token punctuation">(</span><span class="token variable">$awesomeResult</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// or $resolve($anotherPromise);</span>
    <span class="token comment">// or $reject($nastyError);</span>
    <span class="token comment">// or $notify($progressNotification);</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token variable">$canceller</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>callable <span class="token variable">$resolve</span><span class="token punctuation">,</span> callable <span class="token variable">$reject</span><span class="token punctuation">,</span> callable <span class="token variable">$progress</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Cancel/abort any running operations like network connections, streams etc.</span>

    <span class="token variable">$reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Exception</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Promise cancelled'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token variable">$promise</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">React<span class="token punctuation">\</span>Promise<span class="token punctuation">\</span>Promise</span><span class="token punctuation">(</span><span class="token variable">$resolver</span><span class="token punctuation">,</span> <span class="token variable">$canceller</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The promise constructor receives a resolver function and an optional canceller
function which both will be called with 3 arguments:</p> <ul><li><code>$resolve($value)</code> - Primary function that seals the fate of the
returned promise. Accepts either a non-promise value, or another promise.
When called with a non-promise value, fulfills promise with that value.
When called with another promise, e.g. <code>$resolve($otherPromise)</code>, promise's
fate will be equivalent to that of <code>$otherPromise</code>.</li> <li><code>$reject($reason)</code> - Function that rejects the promise.</li> <li><code>$notify($update)</code> - Function that issues progress events for the promise.</li></ul> <p>If the resolver or canceller throw an exception, the promise will be rejected
with that thrown exception as the rejection reason.</p> <p>The resolver function will be called immediately, the canceller function only
once all consumers called the <code>cancel()</code> method of the promise.</p> <h3 id="fulfilledpromise"><a href="#fulfilledpromise" aria-hidden="true" class="header-anchor">#</a> FulfilledPromise</h3> <p>Creates a already fulfilled promise.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>FulfilledPromise</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note, that <code>$value</code> <strong>cannot</strong> be a promise. It's recommended to use
<a href="#resolve">resolve()</a> for creating resolved promises.</p> <h3 id="rejectedpromise"><a href="#rejectedpromise" aria-hidden="true" class="header-anchor">#</a> RejectedPromise</h3> <p>Creates a already rejected promise.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>RejectedPromise</span><span class="token punctuation">(</span><span class="token variable">$reason</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note, that <code>$reason</code> <strong>cannot</strong> be a promise. It's recommended to use
<a href="#reject">reject()</a> for creating rejected promises.</p> <h3 id="lazypromise"><a href="#lazypromise" aria-hidden="true" class="header-anchor">#</a> LazyPromise</h3> <p>Creates a promise which will be lazily initialized by <code>$factory</code> once a consumer
calls the <code>then()</code> method.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$factory</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">React<span class="token punctuation">\</span>Promise<span class="token punctuation">\</span>Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Do some heavy stuff here and resolve the deferred once completed</span>

    <span class="token keyword">return</span> <span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>LazyPromise</span><span class="token punctuation">(</span><span class="token variable">$factory</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// $factory will only be executed once we call then()</span>
<span class="token variable">$promise</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="functions"><a href="#functions" aria-hidden="true" class="header-anchor">#</a> Functions</h3> <p>Useful functions for creating, joining, mapping and reducing collections of
promises.</p> <p>All functions working on promise collections (like <code>all()</code>, <code>race()</code>, <code>some()</code>
etc.) support cancellation. This means, if you call <code>cancel()</code> on the returned
promise, all promises in the collection are cancelled. If the collection itself
is a promise which resolves to an array, this promise is also cancelled.</p> <h4 id="resolve"><a href="#resolve" aria-hidden="true" class="header-anchor">#</a> resolve()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>resolve</span><span class="token punctuation">(</span>mixed <span class="token variable">$promiseOrValue</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a promise for the supplied <code>$promiseOrValue</code>.</p> <p>If <code>$promiseOrValue</code> is a value, it will be the resolution value of the
returned promise.</p> <p>If <code>$promiseOrValue</code> is a thenable (any object that provides a <code>then()</code> method),
a trusted promise that follows the state of the thenable is returned.</p> <p>If <code>$promiseOrValue</code> is a promise, it will be returned as is.</p> <p>Note: The promise returned is always a promise implementing
<a href="#extendedpromiseinterface">ExtendedPromiseInterface</a>. If you pass in a custom
promise which only implements <a href="#promiseinterface">PromiseInterface</a>, this
promise will be assimilated to a extended promise following <code>$promiseOrValue</code>.</p> <h4 id="reject"><a href="#reject" aria-hidden="true" class="header-anchor">#</a> reject()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>reject</span><span class="token punctuation">(</span>mixed <span class="token variable">$promiseOrValue</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a rejected promise for the supplied <code>$promiseOrValue</code>.</p> <p>If <code>$promiseOrValue</code> is a value, it will be the rejection value of the
returned promise.</p> <p>If <code>$promiseOrValue</code> is a promise, its completion value will be the rejected
value of the returned promise.</p> <p>This can be useful in situations where you need to reject a promise without
throwing an exception. For example, it allows you to propagate a rejection with
the value of another promise.</p> <h4 id="all"><a href="#all" aria-hidden="true" class="header-anchor">#</a> all()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>all</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token operator">|</span>React\<span class="token package">Promise<span class="token punctuation">\</span>PromiseInterface</span> <span class="token variable">$promisesOrValues</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns a promise that will resolve only once all the items in
<code>$promisesOrValues</code> have resolved. The resolution value of the returned promise
will be an array containing the resolution values of each of the items in
<code>$promisesOrValues</code>.</p> <h4 id="race"><a href="#race" aria-hidden="true" class="header-anchor">#</a> race()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>race</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token operator">|</span>React\<span class="token package">Promise<span class="token punctuation">\</span>PromiseInterface</span> <span class="token variable">$promisesOrValues</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Initiates a competitive race that allows one winner. Returns a promise which is
resolved in the same way the first settled promise resolves.</p> <h4 id="any"><a href="#any" aria-hidden="true" class="header-anchor">#</a> any()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>any</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token operator">|</span>React\<span class="token package">Promise<span class="token punctuation">\</span>PromiseInterface</span> <span class="token variable">$promisesOrValues</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns a promise that will resolve when any one of the items in
<code>$promisesOrValues</code> resolves. The resolution value of the returned promise
will be the resolution value of the triggering item.</p> <p>The returned promise will only reject if <em>all</em> items in <code>$promisesOrValues</code> are
rejected. The rejection value will be an array of all rejection reasons.</p> <p>The returned promise will also reject with a <code>React\Promise\Exception\LengthException</code>
if <code>$promisesOrValues</code> contains 0 items.</p> <h4 id="some"><a href="#some" aria-hidden="true" class="header-anchor">#</a> some()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>some</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token operator">|</span>React\<span class="token package">Promise<span class="token punctuation">\</span>PromiseInterface</span> <span class="token variable">$promisesOrValues</span><span class="token punctuation">,</span> integer <span class="token variable">$howMany</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns a promise that will resolve when <code>$howMany</code> of the supplied items in
<code>$promisesOrValues</code> resolve. The resolution value of the returned promise
will be an array of length <code>$howMany</code> containing the resolution values of the
triggering items.</p> <p>The returned promise will reject if it becomes impossible for <code>$howMany</code> items
to resolve (that is, when <code>(count($promisesOrValues) - $howMany) + 1</code> items
reject). The rejection value will be an array of
<code>(count($promisesOrValues) - $howMany) + 1</code> rejection reasons.</p> <p>The returned promise will also reject with a <code>React\Promise\Exception\LengthException</code>
if <code>$promisesOrValues</code> contains less items than <code>$howMany</code>.</p> <h4 id="map"><a href="#map" aria-hidden="true" class="header-anchor">#</a> map()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>map</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token operator">|</span>React\<span class="token package">Promise<span class="token punctuation">\</span>PromiseInterface</span> <span class="token variable">$promisesOrValues</span><span class="token punctuation">,</span> callable <span class="token variable">$mapFunc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Traditional map function, similar to <code>array_map()</code>, but allows input to contain
promises and/or values, and <code>$mapFunc</code> may return either a value or a promise.</p> <p>The map function receives each item as argument, where item is a fully resolved
value of a promise or value in <code>$promisesOrValues</code>.</p> <h4 id="reduce"><a href="#reduce" aria-hidden="true" class="header-anchor">#</a> reduce()</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$promise</span> <span class="token operator">=</span> React\<span class="token package">Promise<span class="token punctuation">\</span>reduce</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token operator">|</span>React\<span class="token package">Promise<span class="token punctuation">\</span>PromiseInterface</span> <span class="token variable">$promisesOrValues</span><span class="token punctuation">,</span> callable <span class="token variable">$reduceFunc</span> <span class="token punctuation">,</span> <span class="token variable">$initialValue</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Traditional reduce function, similar to <code>array_reduce()</code>, but input may contain
promises and/or values, and <code>$reduceFunc</code> may return either a value or a
promise, <em>and</em> <code>$initialValue</code> may be a promise or a value for the starting
value.</p> <h3 id="promisorinterface"><a href="#promisorinterface" aria-hidden="true" class="header-anchor">#</a> PromisorInterface</h3> <p>The <code>React\Promise\PromisorInterface</code> provides a common interface for objects
that provide a promise. <code>React\Promise\Deferred</code> implements it, but since it
is part of the public API anyone can implement it.</p> <h2 id="examples"><a href="#examples" aria-hidden="true" class="header-anchor">#</a> Examples</h2> <h3 id="how-to-use-deferred"><a href="#how-to-use-deferred" aria-hidden="true" class="header-anchor">#</a> How to use Deferred</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">function</span> <span class="token function">getAwesomeResultPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">React<span class="token punctuation">\</span>Promise<span class="token punctuation">\</span>Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Execute a Node.js-style function using the callback pattern</span>
    <span class="token function">computeAwesomeResultAsynchronously</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$deferred</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Return the promise</span>
    <span class="token keyword">return</span> <span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">getAwesomeResultPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span>
        <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Deferred resolved, do something with $value</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Deferred rejected, do something with $reason</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$update</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Progress notification triggered, do something with $update</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="how-promise-forwarding-works"><a href="#how-promise-forwarding-works" aria-hidden="true" class="header-anchor">#</a> How promise forwarding works</h3> <p>A few simple examples to show how the mechanics of Promises/A forwarding works.
These examples are contrived, of course, and in real usage, promise chains will
typically be spread across several function calls, or even several levels of
your application architecture.</p> <h4 id="resolution-forwarding"><a href="#resolution-forwarding" aria-hidden="true" class="header-anchor">#</a> Resolution forwarding</h4> <p>Resolved promises forward resolution values to the next promise.
The first promise, <code>$deferred-&gt;promise()</code>, will resolve with the value passed
to <code>$deferred-&gt;resolve()</code> below.</p> <p>Each call to <code>then()</code> returns a new promise that will resolve with the return
value of the previous handler. This creates a promise &quot;pipeline&quot;.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">React<span class="token punctuation">\</span>Promise<span class="token punctuation">\</span>Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// $x will be the value passed to $deferred-&gt;resolve() below</span>
        <span class="token comment">// and returns a *new promise* for $x + 1</span>
        <span class="token keyword">return</span> <span class="token variable">$x</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// $x === 2</span>
        <span class="token comment">// This handler receives the return value of the</span>
        <span class="token comment">// previous handler.</span>
        <span class="token keyword">return</span> <span class="token variable">$x</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// $x === 3</span>
        <span class="token comment">// This handler receives the return value of the</span>
        <span class="token comment">// previous handler.</span>
        <span class="token keyword">return</span> <span class="token variable">$x</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// $x === 4</span>
        <span class="token comment">// This handler receives the return value of the</span>
        <span class="token comment">// previous handler.</span>
        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Resolve '</span> <span class="token punctuation">.</span> <span class="token variable">$x</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Prints &quot;Resolve 4&quot;</span>
</code></pre></div><h4 id="rejection-forwarding"><a href="#rejection-forwarding" aria-hidden="true" class="header-anchor">#</a> Rejection forwarding</h4> <p>Rejected promises behave similarly, and also work similarly to try/catch:
When you catch an exception, you must rethrow for it to propagate.</p> <p>Similarly, when you handle a rejected promise, to propagate the rejection,
&quot;rethrow&quot; it by either returning a rejected promise, or actually throwing
(since promise translates thrown exceptions into rejections)</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">React<span class="token punctuation">\</span>Promise<span class="token punctuation">\</span>Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Exception</span><span class="token punctuation">(</span><span class="token variable">$x</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">otherwise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>\<span class="token package">Exception</span> <span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Propagate the rejection</span>
        <span class="token keyword">throw</span> <span class="token variable">$x</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">otherwise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>\<span class="token package">Exception</span> <span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Can also propagate by returning another rejection</span>
        <span class="token keyword">return</span> React\<span class="token package">Promise<span class="token punctuation">\</span>reject</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Exception</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">otherwise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Reject '</span> <span class="token punctuation">.</span> <span class="token variable">$x</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Prints &quot;Reject 3&quot;</span>
</code></pre></div><h4 id="mixed-resolution-and-rejection-forwarding"><a href="#mixed-resolution-and-rejection-forwarding" aria-hidden="true" class="header-anchor">#</a> Mixed resolution and rejection forwarding</h4> <p>Just like try/catch, you can choose to propagate or not. Mixing resolutions and
rejections will still forward handler results in a predictable way.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">React<span class="token punctuation">\</span>Promise<span class="token punctuation">\</span>Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$x</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Exception</span><span class="token punctuation">(</span><span class="token variable">$x</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">otherwise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>\<span class="token package">Exception</span> <span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Handle the rejection, and don't propagate.</span>
        <span class="token comment">// This is like catch without a rethrow</span>
        <span class="token keyword">return</span> <span class="token variable">$x</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Mixed '</span> <span class="token punctuation">.</span> <span class="token variable">$x</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Prints &quot;Mixed 4&quot;</span>
</code></pre></div><h4 id="progress-event-forwarding"><a href="#progress-event-forwarding" aria-hidden="true" class="header-anchor">#</a> Progress event forwarding</h4> <p>In the same way as resolution and rejection handlers, your progress handler
<strong>MUST</strong> return a progress event to be propagated to the next link in the chain.
If you return nothing, <code>null</code> will be propagated.</p> <p>Also in the same way as resolutions and rejections, if you don't register a
progress handler, the update will be propagated through.</p> <p>If your progress handler throws an exception, the exception will be propagated
to the next link in the chain. The best thing to do is to ensure your progress
handlers do not throw exceptions.</p> <p>This gives you the opportunity to transform progress events at each step in the
chain so that they are meaningful to the next step. It also allows you to choose
not to transform them, and simply let them propagate untransformed, by not
registering a progress handler.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">React<span class="token punctuation">\</span>Promise<span class="token punctuation">\</span>Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">progress</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$update</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$update</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">progress</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$update</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Progress '</span> <span class="token punctuation">.</span> <span class="token variable">$update</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$deferred</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Prints &quot;Progress 2&quot;</span>
</code></pre></div><h3 id="done-vs-then"><a href="#done-vs-then" aria-hidden="true" class="header-anchor">#</a> done() vs. then()</h3> <p>The golden rule is:</p> <pre><code>Either return your promise, or call done() on it.
</code></pre> <p>At a first glance, <code>then()</code> and <code>done()</code> seem very similar. However, there are
important distinctions.</p> <p>The intent of <code>then()</code> is to transform a promise's value and to pass or return
a new promise for the transformed value along to other parts of your code.</p> <p>The intent of <code>done()</code> is to consume a promise's value, transferring
responsibility for the value to your code.</p> <p>In addition to transforming a value, <code>then()</code> allows you to recover from, or
propagate intermediate errors. Any errors that are not handled will be caught
by the promise machinery and used to reject the promise returned by <code>then()</code>.</p> <p>Calling <code>done()</code> transfers all responsibility for errors to your code. If an
error (either a thrown exception or returned rejection) escapes the
<code>$onFulfilled</code> or <code>$onRejected</code> callbacks you provide to done, it will be
rethrown in an uncatchable way causing a fatal error.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">function</span> <span class="token function">getJsonResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">queryApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">then</span><span class="token punctuation">(</span>
            <span class="token comment">// Transform API results to an object</span>
            <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$jsonResultString</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$jsonResultString</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">// Transform API errors to an exception</span>
            <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$jsonErrorString</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$object</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$jsonErrorString</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ApiErrorException</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">errorMessage</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Here we provide no rejection handler. If the promise returned has been</span>
<span class="token comment">// rejected, the ApiErrorException will be thrown</span>
<span class="token function">getJsonResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">done</span><span class="token punctuation">(</span>
        <span class="token comment">// Consume transformed object</span>
        <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$jsonResultObject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Do something with $jsonResultObject</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Here we provide a rejection handler which will either throw while debugging</span>
<span class="token comment">// or log the exception</span>
<span class="token function">getJsonResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">done</span><span class="token punctuation">(</span>
        <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$jsonResultObject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Do something with $jsonResultObject</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">function</span> <span class="token punctuation">(</span>ApiErrorException <span class="token variable">$exception</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token variable">$exception</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">logException</span><span class="token punctuation">(</span><span class="token variable">$exception</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note that if a rejection value is not an instance of <code>\Exception</code>, it will be
wrapped in an exception of the type <code>React\Promise\UnhandledRejectionException</code>.</p> <p>You can get the original rejection reason by calling <code>$exception-&gt;getReason()</code>.</p> <h2 id="credits"><a href="#credits" aria-hidden="true" class="header-anchor">#</a> Credits</h2> <p>React/Promise is a port of <a href="https://github.com/cujojs/when" target="_blank" rel="noopener noreferrer">when.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
by <a href="https://github.com/briancavalier" target="_blank" rel="noopener noreferrer">Brian Cavalier<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Also, large parts of the documentation have been ported from the when.js
<a href="https://github.com/cujojs/when/wiki" target="_blank" rel="noopener noreferrer">Wiki<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and the
<a href="https://github.com/cujojs/when/blob/master/docs/api.md" target="_blank" rel="noopener noreferrer">API docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="license"><a href="#license" aria-hidden="true" class="header-anchor">#</a> License</h2> <p>React/Promise is released under the <a href="https://github.com/reactphp/promise/blob/master/LICENSE" target="_blank" rel="noopener noreferrer">MIT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> license.</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="Laputa/assets/js/161.df7bc156.js" defer></script><script src="Laputa/assets/js/app.6f999ec1.js" defer></script>
  </body>
</html>
